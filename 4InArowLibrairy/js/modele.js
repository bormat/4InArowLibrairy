// Generated by LiveScript 1.4.0
(function(){
  var Disc, Modele, mettrePion;
  Disc = (function(){
    Disc.displayName = 'Disc';
    var prototype = Disc.prototype, constructor = Disc;
    function Disc(pos){
      this.pos = pos;
      this.initColorNumber = Modele.grille[this.pos];
    }
    prototype.goToDir = function(dir){
      var newPos, pos;
      newPos = this.pos;
      for (;;) {
        pos = newPos;
        newPos = pos + dir;
        if (!(Disc.distance(pos, newPos) <= 1 && Modele.grille[newPos] == this.initColorNumber)) {
          break;
        }
      }
      return pos;
    };
    return Disc;
  }());
  Disc.distance = function(disc1, disc2, xOrY){
    var distX, x$, distY, y$;
    distX = disc2 % 7 - disc1 % 7;
    x$ = Math.floor;
    distY = x$(disc2 / 7) - x$(disc1 / 7);
    y$ = Math.abs;
    return Math.max(y$(distX), y$(distY));
    return y$;
  };
  window.Modele = Modele = {
    isGameFinish: function(){
      var isGameFinish;
      isGameFinish = void 8;
      return this.isGameFinish = function(pos){
        var disc;
        if (!(pos == undefined)) {
          if (typeof pos == 'boolean') {
            isGameFinish = pos;
          } else {
            if (pos < 0) {
              return false;
            }
            disc = new Disc(pos);
            [1, 6, 7, 8].some(function(direction){
              var start1, start2;
              start1 = disc.goToDir(-direction);
              start2 = disc.goToDir(direction);
              if (isGameFinish = Disc.distance(start1, start2) >= 3) {
                Modele.winInfo = {
                  pion1: start1,
                  pion2: start2,
                  dir: direction
                };
                return true;
              }
            });
          }
        }
        return isGameFinish;
      };
    },
    play: function(position, test){
      position %= 7;
      while (Modele.grille[position + 7] == 0 && position < 37) {
        position += 7;
      }
      if (Modele.grille[position] == 0) {
        Modele.mettrePion(position, test);
        return position;
      }
      return -1;
    },
    mettrePion: mettrePion = function(position, test){
      Modele.grille[position] = Modele.getPlayer();
      if (!test) {
        Modele.nextPlayer();
        Modele.backup.push(position);
      }
      Modele.isGameFinish(position);
      if (test) {
        Modele.grille[position] = 0;
      }
      return Modele.isGameFinish();
    },
    playAgain: function(emplacement){
      Modele.isGameFinish(false);
      Modele.init();
      Modele.setPlayer(1);
      Modele.play(3);
      return Modele.backup = [38];
    },
    joueur: '1',
    grille: [],
    backup: [],
    init: function(){
      var i;
      i = 0;
      while (i < 42) {
        Modele.grille[i] = 0;
        i++;
      }
      return Modele.isGameFinish(false);
    },
    setGrille: function(tab){
      var i, results$ = [];
      i = 0;
      while (i < 42) {
        Modele.grille[i] = tab[i];
        results$.push(i++);
      }
      return results$;
    },
    setModel: function(tab){
      return Modele.setGrille(Modele.modelToArray(tab));
    },
    modelToArray: function(tab){
      var tab2, lengthLine, i, o;
      tab2 = [];
      lengthLine = tab[0].length;
      i = 0;
      while (i < tab.length) {
        o = 0;
        while (o < lengthLine) {
          tab2.push(tab[i][o]);
          o++;
        }
        i++;
      }
      return tab2;
    },
    loadTab: function(tab, emplacement){
      return Modele.grille = Modele.modelToArray(tab);
    },
    nextPlayer: function(){
      return Modele.joueur = Modele.joueur == 1 ? 2 : 1;
    },
    getPlayer: function(dec){
      var nb;
      nb = parseInt(Modele.joueur);
      if (dec == 1) {
        nb = nb % 2 + 1;
      }
      return nb;
    },
    setPlayer: function(number){
      return Modele.joueur = number;
    },
    isHumanTurn: function(){
      return Modele.joueur == 1;
    },
    undo: function(emplacement, Nothuman){
      var pos;
      Modele.isGameFinish(false);
      pos = Modele.backup.pop();
      if (pos == 38) {
        return Modele.backup.push(pos);
      }
      Modele.grille[pos] = 0;
      Modele.nextPlayer();
      return pos;
    },
    restore: function(backup){
      var joueur, i;
      Modele.partiFini = false;
      Modele.init();
      joueur = 1;
      Modele.backup = backup;
      i = backup.lastIndexOf(38);
      while (i < backup.length) {
        if (Modele.grille[backup[i]] == 0) {
          Modele.grille[backup[i]] = joueur;
          joueur = joueur % 2 + 1;
        }
        i++;
      }
      return Modele.setPlayer(Modele.backup % 2 + 1);
    },
    saveGame: function(){
      $.cookie('grille', JSON.stringify(Modele.backup));
      return $.cookie('boolSmart', JSON.stringify(IA.boolSmart));
    }
  };
  Modele.init();
}).call(this);
